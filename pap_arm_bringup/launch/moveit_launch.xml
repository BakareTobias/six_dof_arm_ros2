<launch>
    <let
        name="urdf_path" 
        value="$(find-pkg-share pap_arm)/urdf/pap_arm.xacro"/>

    <let
        name="ros2_control_config_path"
        value="$(find-pkg-share pap_arm_bringup)/config/ros2_controllers.yaml"/>
    
    <let 
        name="rviz_config_path"
        value="$(find-pkg-share pap_arm)/rviz/rviz.rviz"/>

             
    <!-- 1. Launch the robot state publisher -->
    <node pkg="robot_state_publisher" exec="robot_state_publisher">
        <param name="robot_description"
                value="$(command 'xacro $(var urdf_path)')"/>
    </node>

    <!-- 2. Start the robot controller manager -->
    <node pkg="controller_manager" exec="ros2_control_node">
        <param from="$(var ros2_control_config_path)"/>
    </node>

    <!-- 3. Spawn joint_state_broadcaster -->
    <node pkg="controller_manager" exec="spawner" args="joint_state_broadcaster"/>

    <!-- 4a. Spawn arm_controller -->
    <node pkg="controller_manager" exec="spawner" args="arm_controller"/>

    <!-- 4b. Spawn gripper_controller -->
    <node pkg="controller_manager" exec="spawner" args="claw_controller"/>

    <!-- 5. Launch MoveIt -->
    <include file="$(find-pkg-share pap_arm_moveit_config)/launch/move_group.launch.py"/>

    <!-- 6. Launch RViz -->
    <node pkg="rviz2" exec="rviz2" name="rviz2" args="-d $(var rviz_config_path)" output="screen"/>

    <!-- 7. Start the commander -->
    <node pkg="my_robot_commander_cpp" exec="commander"/>

    <!-- 8. Run some commands -->
    <!-- a. go to pose_1 -->
    
    
</launch>